<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>yall: src/writer/thread.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">yall
   &#160;<span id="projectnumber">1.8.1</span>
   </div>
   <div id="projectbrief">C lightweight logging library</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('thread_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">thread.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="thread_8h_source.html">yall/writer/thread.h</a>&quot;</code><br />
<code>#include &lt;pthread.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdbool.h&gt;</code><br />
<code>#include &lt;time.h&gt;</code><br />
<code>#include &quot;<a class="el" href="debug_8h_source.html">yall/debug.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="error_8h_source.html">yall/error.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="queue_8h_source.html">yall/queue.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="types_8h_source.html">yall/output/types.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="message_8h_source.html">yall/message.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="writer_2file_8h_source.html">yall/writer/file.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="writer_2console_8h_source.html">yall/writer/console.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a47d5b6e774afb443f6e03a693605be2a"><td class="memItemLeft" align="right" valign="top">static void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thread_8c.html#a47d5b6e774afb443f6e03a693605be2a">writer_thread</a> (void *args)</td></tr>
<tr class="memdesc:a47d5b6e774afb443f6e03a693605be2a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main function of the writer threader. It loops at &gt;thread_frequency&gt; Hz. Messages queue is swapped on each loop, wrote and deleted. Once the library is closed, <em>thread_run</em> is set to false and the thread stop when the messages queue has been wrote a last time.  <a href="#a47d5b6e774afb443f6e03a693605be2a">More...</a><br /></td></tr>
<tr class="separator:a47d5b6e774afb443f6e03a693605be2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac294f4f0692261634ceaf361fb57e91"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thread_8c.html#aac294f4f0692261634ceaf361fb57e91">start_thread</a> (uint16_t frequency, <a class="el" href="structcqueue__t.html">cqueue_t</a> *messages_queue)</td></tr>
<tr class="memdesc:aac294f4f0692261634ceaf361fb57e91"><td class="mdescLeft">&#160;</td><td class="mdescRight">Start the writer thread of the library. It is better to use <a class="el" href="writer_8c.html#a6b76c9339c55ad27aaa979a293f4f7d3" title="Start the writing thread. Also, this function does create a cqueue_t object and send it to the thread...">writer_init()</a> instead, as it could setup environment before.  <a href="#aac294f4f0692261634ceaf361fb57e91">More...</a><br /></td></tr>
<tr class="separator:aac294f4f0692261634ceaf361fb57e91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c54ec99852c3d09447f268f4b84caab"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thread_8c.html#a4c54ec99852c3d09447f268f4b84caab">stop_thread</a> (void)</td></tr>
<tr class="memdesc:a4c54ec99852c3d09447f268f4b84caab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stop the writing thread.It is better to use writer_stop() instead, as it could setup environment before.  <a href="#a4c54ec99852c3d09447f268f4b84caab">More...</a><br /></td></tr>
<tr class="separator:a4c54ec99852c3d09447f268f4b84caab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a821100fbde18638b2baae2dbf619deab"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thread_8c.html#a821100fbde18638b2baae2dbf619deab">handle_messages_queue</a> (<a class="el" href="structcqueue__t.html">cqueue_t</a> *q)</td></tr>
<tr class="memdesc:a821100fbde18638b2baae2dbf619deab"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function is used to write all the message from the given queue, through all writer function (<a class="el" href="console_8c.html#a173be55eb583bc3feb80b59f86033dfb" title="Write the log message on the console. The message can&#39;t be NULL. The color of the message depend of t...">write_log_console()</a>, <a class="el" href="file_8c.html#a74e97db67d8c58e3c0c7542ea3b9367f" title="Write the message to the given log file. ">write_log_file()</a>, ...). The given message queue must be reversed as, for concurrency purposes, we can't enqueue message in the proper order. Thus, is the queue is not reversed, the messages will be printed in reversed order. Once the given queue has been wrote, it is freed.  <a href="#a821100fbde18638b2baae2dbf619deab">More...</a><br /></td></tr>
<tr class="separator:a821100fbde18638b2baae2dbf619deab"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a72fcd245d014687847a9d7c8ac069892"><td class="memItemLeft" align="right" valign="top">static uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thread_8c.html#a72fcd245d014687847a9d7c8ac069892">thread_frequency</a></td></tr>
<tr class="separator:a72fcd245d014687847a9d7c8ac069892"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01f75a9ad916f63a94e06a27635ba278"><td class="memItemLeft" align="right" valign="top">static pthread_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thread_8c.html#a01f75a9ad916f63a94e06a27635ba278">thread</a></td></tr>
<tr class="separator:a01f75a9ad916f63a94e06a27635ba278"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a327f0b74c017f8cf5050f8dfa329c209"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="structcqueue__t.html">cqueue_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="thread_8c.html#a327f0b74c017f8cf5050f8dfa329c209">messages</a> = NULL</td></tr>
<tr class="separator:a327f0b74c017f8cf5050f8dfa329c209"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a821100fbde18638b2baae2dbf619deab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a821100fbde18638b2baae2dbf619deab">&#9670;&nbsp;</a></span>handle_messages_queue()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void handle_messages_queue </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcqueue__t.html">cqueue_t</a> *&#160;</td>
          <td class="paramname"><em>q</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function is used to write all the message from the given queue, through all writer function (<a class="el" href="console_8c.html#a173be55eb583bc3feb80b59f86033dfb" title="Write the log message on the console. The message can&#39;t be NULL. The color of the message depend of t...">write_log_console()</a>, <a class="el" href="file_8c.html#a74e97db67d8c58e3c0c7542ea3b9367f" title="Write the message to the given log file. ">write_log_file()</a>, ...). The given message queue must be reversed as, for concurrency purposes, we can't enqueue message in the proper order. Thus, is the queue is not reversed, the messages will be printed in reversed order. Once the given queue has been wrote, it is freed. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">q</td><td>Concurrent queue containing the messages. This queue must be ready for '<a class="el" href="cqueue_8c.html#a0b7f7e3c96b3aee8ef43aee6f59098a7" title="Dequeue the last node of the given queue and return the data. The node is deleted. This function is thread-safe. ">cq_dequeue()</a>' calls. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aac294f4f0692261634ceaf361fb57e91"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac294f4f0692261634ceaf361fb57e91">&#9670;&nbsp;</a></span>start_thread()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t start_thread </td>
          <td>(</td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>frequency</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcqueue__t.html">cqueue_t</a> *&#160;</td>
          <td class="paramname"><em>messages_queue</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Start the writer thread of the library. It is better to use <a class="el" href="writer_8c.html#a6b76c9339c55ad27aaa979a293f4f7d3" title="Start the writing thread. Also, this function does create a cqueue_t object and send it to the thread...">writer_init()</a> instead, as it could setup environment before. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">frequency</td><td>Frequency to use for the writer's thread loops. </td></tr>
    <tr><td class="paramname">messages_queue</td><td><a class="el" href="structcqueue__t.html" title="This structure represents a concurrent queue. ">cqueue_t</a> object representing the messages queue used to communicate with the thread. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Error code depending of the success or failure of the function. </dd></dl>

</div>
</div>
<a id="a4c54ec99852c3d09447f268f4b84caab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c54ec99852c3d09447f268f4b84caab">&#9670;&nbsp;</a></span>stop_thread()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void stop_thread </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Stop the writing thread.It is better to use writer_stop() instead, as it could setup environment before. </p>

</div>
</div>
<a id="a47d5b6e774afb443f6e03a693605be2a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47d5b6e774afb443f6e03a693605be2a">&#9670;&nbsp;</a></span>writer_thread()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void * writer_thread </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>args</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Main function of the writer threader. It loops at &gt;thread_frequency&gt; Hz. Messages queue is swapped on each loop, wrote and deleted. Once the library is closed, <em>thread_run</em> is set to false and the thread stop when the messages queue has been wrote a last time. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">args</td><td>Arguments to use inside the thread, required by pthread but unused. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a327f0b74c017f8cf5050f8dfa329c209"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a327f0b74c017f8cf5050f8dfa329c209">&#9670;&nbsp;</a></span>messages</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structcqueue__t.html">cqueue_t</a>* messages = NULL</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a01f75a9ad916f63a94e06a27635ba278"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a01f75a9ad916f63a94e06a27635ba278">&#9670;&nbsp;</a></span>thread</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pthread_t thread</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a72fcd245d014687847a9d7c8ac069892"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72fcd245d014687847a9d7c8ac069892">&#9670;&nbsp;</a></span>thread_frequency</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t thread_frequency</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_d23ba569ffb931581bcd85a3af3f3bc5.html">writer</a></li><li class="navelem"><a class="el" href="thread_8c.html">thread.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
